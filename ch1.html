<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>回归</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>



<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>回归</h1>

<h1>回归</h1>

<p>回归是数据分析、推断及预测的基本出发点。</p>

<h1>均值回归</h1>

<p>首先猜一个随机数量的值，如果没有任何其他信息，判断预测好坏要通过与真实值的比对，于是有如下函数表示预测误差：</p>

<p>\( MSE(\alpha) \equiv E[(Y - \alpha)^2] \)</p>

<p>这里使用了均方误，使这个函数最小有:</p>

<p>\( MSE(\alpha) = (E[Y]-\alpha)^2 + Var[Y] \)</p>

<p>对\( \alpha \)求导，可得当\( \alpha = E[Y] \)时预测误差最小。换言之，使用均方误表示预测误差的函数，最佳预测点为\( Y \)的均值。</p>

<p>当样本为IID时，大数定律表明这个均值可通过对样本取均值获得，收敛速度与取样数跟总体方差有关。</p>

<h1>回归方程</h1>

<p>如果知道有其他数量与要预测的量有关系，可以通过这些自变量去预测因变量，背后关系为一种条件概率形式：</p>

<p>\( E[U] = E[E[U|V]] \)</p>

<p>这样我们可以把\( Y \)写成\( f(x) \)的形式，有：</p>

<p>\( MSE(f(x)) = E[Var[Y|X]+(E[Y - f(x)|X])^2] \)</p>

<p>因为预测只依赖\( f(x) \)，所以有需优化的回归函数:</p>

<p>\( \gamma(x) = E[Y|X = x] \)</p>

<p>因此\( \gamma(x) \)可理解为条件期望的回归函数。</p>

<p>当使用自变量与因变量术语时，默认存在因果模型：</p>

<p>\( Y \leftarrow \gamma(X) + \epsilon \)</p>

<p>其中默认\( \epsilon \)为具有固定分布独立于\( X \)的误差项，但实际过程无法假定两个变量存在关系，有：</p>

<p>\( Y|X = \gamma(X) + \eta(X) \)</p>

<p>\( \eta(X) \)是均值0的噪音项，依赖于\( X \)，同时即使\( \gamma(X) \)为常数也不说明\( X \)与\( Y \)是独立的，即达到相同的结果不说明原因相同或不同。</p>

<h1>估计回归方程</h1>

<p>如果\( X \)无限存在，那么预测\( Y \)可以通过条件样本平均值，在给定大量\( X \)下求\( Y \)的均值：</p>

<p>\( \hat \gamma(x) = \frac{1}{i:x_i  = x} \sum_{i:x_i = x} y_i \)</p>

<p>大数定理下 \( \hat \gamma(x) \rightarrow E[Y|X=x] \)</p>

<p>但现实状况是预测总是基于已有\( X \)来考虑\( Y \)，这就存在两个问题：\( X \)不够采样导致预测存在偏差；关系能否外推并平滑。</p>

<p>进行模型预测时，实际上是通过一种模型将实际过程的自变量限制到一种与因变量的关系里，这个关系是对真实关系的近似。在\( x \)点有</p>

<p>\( MSE(\hat \gamma (x)) = \sigma_x^2 + ((\gamma(x) - \hat \gamma (x))^2 \)</p>

<p>前者为\( x \)作为预测形成的统计扰动，后者是实际预测与真实预测的偏差。</p>

<p>另一个\( MSE \)来自实际预测的模型受到有限样本的条件限制为\( MSE(\hat R_n (x)| \hat R_n = \hat \gamma) \) 有</p>

<p>\( MSE(\hat R_n(x)) = \sigma_x^2 + (\gamma(x) - E[\hat R_n(x)])^2 + Var[\hat R_n(x)] \)</p>

<p>第一项为\( x \)预测形成的统计扰动，第二项是估计偏差，第三项是估计模型的变动。</p>

<p>也就是说，在特定的点上，降低估计偏差会提高估计模型的变动，也就是*bias-variance trade-off*。因为偏差与统计模型降低的速度不一，我们可以期望得到一个\( MSE \)最小的建模估计，拟合越精细，偏差越小，但模型受\( x \)影响变动大，在预测上受影响大。</p>

<p>最小二乘回归是最小化均方误，也就是</p>

<p>\( MSE(\alpha,\beta) = E[(Y-\alpha-\beta X)^2|X] = E[Var[Y|X]]+E[(E[Y-\alpha-\beta X|X])^2] \)</p>

<p>前面一项无参数，对后面微分，可得</p>

<p>\( \frac{dMSE}{d\alpha} = E[2(Y-\alpha-\beta X)(-1)] \)
最小二乘回归的本质是在训练集中对因变量的中心平滑。</p>

<p>均值回归与最小二乘回归是线性平滑的特例</p>

<p>\( \hat r(x)=\sum_i y_i \hat \omega (x_i,x) \)</p>

<p>均值是\( \hat \omega(x_i,x) = 1/n \) OLS是\( \hat \omega(x_i,x) = (x_i/ns_X^2)x \)</p>

</body>

</html>

