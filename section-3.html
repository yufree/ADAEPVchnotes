<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Advanced Data Analysis from an Elementary Point of View 中文笔记</title>
  <meta name="description" content="Advanced Data Analysis from an Elementary Point of View 中文笔记">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Advanced Data Analysis from an Elementary Point of View 中文笔记" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Advanced Data Analysis from an Elementary Point of View 中文笔记" />
  
  
  

<meta name="author" content="于淼">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="section-2.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 前言</a></li>
<li class="chapter" data-level="2" data-path="section-2.html"><a href="section-2.html"><i class="fa fa-check"></i><b>2</b> 回归：预测与相关定量特征</a><ul>
<li class="chapter" data-level="2.1" data-path="section-2.html"><a href="section-2.html#-"><i class="fa fa-check"></i><b>2.1</b> 统计学 数据分析与回归</a></li>
<li class="chapter" data-level="2.2" data-path="section-2.html"><a href="section-2.html#section-2.2"><i class="fa fa-check"></i><b>2.2</b> 均值回归</a><ul>
<li class="chapter" data-level="2.2.1" data-path="section-2.html"><a href="section-2.html#section-2.2.1"><i class="fa fa-check"></i><b>2.2.1</b> 估计期望值</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="section-2.html"><a href="section-2.html#section-2.3"><i class="fa fa-check"></i><b>2.3</b> 回归方程</a><ul>
<li class="chapter" data-level="2.3.1" data-path="section-2.html"><a href="section-2.html#section-2.3.1"><i class="fa fa-check"></i><b>2.3.1</b> 声明</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="section-2.html"><a href="section-2.html#section-2.4"><i class="fa fa-check"></i><b>2.4</b> 估计回归方程</a><ul>
<li class="chapter" data-level="2.4.1" data-path="section-2.html"><a href="section-2.html#bias-variance-tradeoff"><i class="fa fa-check"></i><b>2.4.1</b> Bias-Variance Tradeoff</a></li>
<li class="chapter" data-level="2.4.2" data-path="section-2.html"><a href="section-2.html#section-2.4.2"><i class="fa fa-check"></i><b>2.4.2</b> 最小二乘拟合</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="section-2.html"><a href="section-2.html#section-2.5"><i class="fa fa-check"></i><b>2.5</b> 线性平滑</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="section-3.html"><a href="section-3.html"><i class="fa fa-check"></i><b>3</b> 线性回归的真相</a><ul>
<li class="chapter" data-level="3.1" data-path="section-3.html"><a href="section-3.html#section-3.1"><i class="fa fa-check"></i><b>3.1</b> 多变量回归</a><ul>
<li class="chapter" data-level="3.1.1" data-path="section-3.html"><a href="section-3.html#section-3.1.1"><i class="fa fa-check"></i><b>3.1.1</b> 共线性</a></li>
<li class="chapter" data-level="3.1.2" data-path="section-3.html"><a href="section-3.html#section-3.1.2"><i class="fa fa-check"></i><b>3.1.2</b> 预测残差</a></li>
<li class="chapter" data-level="3.1.3" data-path="section-3.html"><a href="section-3.html#section-3.1.3"><i class="fa fa-check"></i><b>3.1.3</b> 估计最佳线性预测函数</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="section-2.html"><a href="section-2.html#-"><i class="fa fa-check"></i><b>3.2</b> 分布变动 缺失变量与转化</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Data Analysis from an Elementary Point of View 中文笔记</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-3" class="section level1">
<h1><span class="header-section-number">3</span> 线性回归的真相</h1>
<div id="section-3.1" class="section level2">
<h2><span class="header-section-number">3.1</span> 多变量回归</h2>
<p>回归函数<span class="math inline">\(r(\vec x)\)</span>可用Taylor展开式展开：</p>
<p><span class="math inline">\(r(\vec x) = r(\vec u) + (\vec x - \vec u) \cdot \nabla r(\vec u) + O(||\vec x - \vec u||^2)\)</span></p>
<p>求解其参数<span class="math inline">\(\beta\)</span>：</p>
<p><span class="math inline">\(\beta = v^{-1} Cov [\vec X, Y]\)</span></p>
<p><span class="math inline">\(v\)</span>是<span class="math inline">\(\bar X\)</span>的协方差矩阵，<span class="math inline">\(Cov [\vec X, Y]\)</span>是自变量与因变量的协方差矩阵。</p>
<p>自变量没有共线性时，每个自变量的系数可以单独求加起来，有的话考虑协方差矩阵。</p>
<div id="section-3.1.1" class="section level3">
<h3><span class="header-section-number">3.1.1</span> 共线性</h3>
<p>共线性会导致<span class="math inline">\(v\)</span>不可逆，不要在自变量选择上出现线性组合。</p>
</div>
<div id="section-3.1.2" class="section level3">
<h3><span class="header-section-number">3.1.2</span> 预测残差</h3>
<p><span class="math inline">\(Cov[Y - \vec X \cdot \beta] = Cov[Y, \vec X] - Cov[\vec X \cdot (v^{-1} Cov[\vec X, Y]), \vec X] = Cov[Y, \vec X] - v v^{-1} Cov[Y, \vec X] = 0\)</span></p>
<p>预测残差对整体<span class="math inline">\(\vec X\)</span>可以是0，对特定<span class="math inline">\(\vec x\)</span>预测残差不是0。</p>
</div>
<div id="section-3.1.3" class="section level3">
<h3><span class="header-section-number">3.1.3</span> 估计最佳线性预测函数</h3>
<p>大数法则，样本协方差会逼近真实协方差，有：</p>
<p><span class="math inline">\(\hat \beta = (x^T x)^{-1} x^T y \rightarrow \beta\)</span></p>
<p>或者最小化残差平方和：</p>
<p><span class="math inline">\(RSS(\beta) \equiv \sum_{i=1}^n (y_i - \vec x_i \cdot \beta)^2\)</span></p>
<p>最小化也需要协方差但不需要概率假设，但考虑参数<span class="math inline">\(\hat \beta\)</span>的收敛需要不变的协方差概率分布假设。</p>
<div id="section-3.1.3.1" class="section level4">
<h4><span class="header-section-number">3.1.3.1</span> 最小二乘估计的无偏性与方差</h4>
<p>考虑<span class="math inline">\(x\)</span>固定，<span class="math inline">\(Y\)</span>是随机的，有：</p>
<p><span class="math inline">\(Y = \vec X \cdot \beta + \epsilon\)</span></p>
<p>其中<span class="math inline">\(E[\epsilon] = 0\)</span>，<span class="math inline">\(Cov[\epsilon, \vec X] = 0\)</span></p>
<p>可得参数<span class="math inline">\(\beta\)</span>为：</p>
<p><span class="math inline">\(\hat \beta = (x^T x)^{-1} x^T Y = \beta + (x^T x)^{-1} x^T \epsilon\)</span></p>
<p>这告诉我们<span class="math inline">\(\hat \beta\)</span>是无偏的：</p>
<p><span class="math inline">\(E[\hat \beta|x] = \beta + (x^T x)^{-1} x^T E[\epsilon] = \beta + 0 = \beta\)</span></p>
<p>也可得到<span class="math inline">\(\hat \beta\)</span>的方差：</p>
<p><span class="math inline">\(Var[\hat \beta| x ] = Var[\beta + (x^T x)^{-1} x^T \epsilon |x] = Var[(x^T x)^{-1} x^T \epsilon | x] = E[((x^T x)^{-1} x^T \epsilon)^2 | x] = (x^T x)^{-1} x^T Var[\epsilon|x] x (x^T x)^{-1}\)</span></p>
<p>当<span class="math inline">\(\epsilon\)</span>等方差为<span class="math inline">\(\sigma^2\)</span>时，有：</p>
<p><span class="math inline">\(Var[\hat \beta|x] = \sigma^2 (x^T x)^{-1}\)</span></p>
<p>即：</p>
<p><span class="math inline">\(Var[\hat \beta] = \frac{\sigma^2}{n} v^{-1}\)</span></p>
<p>系数<span class="math inline">\(\hat \beta\)</span>的方差会随样本数上升而下降，线性变差而变大，自变量协方差变大（不相关）而变小。</p>
</div>
</div>
</div>
<div id="-" class="section level2">
<h2><span class="header-section-number">3.2</span> 分布变动 缺失变量与转化</h2>
<ul>
<li><p>有些模型非线性但可得到较高<span class="math inline">\(R^2\)</span>.</p></li>
<li><p>缺失的潜在变量如果与已知变量相关会影响自变量对因变量的回归。例如<span class="math inline">\(Y \sim \mathcal N(X+Z,0.01)\)</span>, 如果<span class="math inline">\(X\)</span>与<span class="math inline">\(Z\)</span>正相关，<span class="math inline">\(Y\)</span>预测会偏高，反之<span class="math inline">\(Y\)</span>回归均值。这一变化是因为潜在变量的存在而不是其与<span class="math inline">\(Y\)</span>的回归关系。</p></li>
<li><p>有时变量是另一个变量的扭曲<span class="math inline">\(\vec X = \vec U + \vec \eta\)</span>，<span class="math inline">\(\eta\)</span>是某种噪音，这会导致估计的参数偏小，不过不用钻牛角尖，真实数据总是这样。</p></li>
<li>数据转化可同时操作<span class="math inline">\(X\)</span>与<span class="math inline">\(Y\)</span>，但推荐在<span class="math inline">\(X\)</span>上：</li>
<li><span class="math inline">\(E[f(Y)] \neq f(E[Y])\)</span> 使用最小二乘法会产生偏差</li>
<li>自变量间的转化形式可以不同</li>
<li><p>可以使用复杂形式的协变量</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-2.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
